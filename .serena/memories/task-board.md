# Task Board
## Session: session-20260215-150652

| Agent | Status | Task |
|-------|--------|------|
| Gemini | Done | DID 로그인 정책 문서 초안 작성 및 사용자 플로우 정의 |

---

# DID 로그인 정책 문서 (초안)

## 1. 개요
본 문서는 MiID 프로젝트의 DID(Decentralized Identity) 기반 로그인 시스템에 대한 정책 및 운영 가이드를 정의합니다. 사용자가 자신의 신원 정보를 주체적으로 관리하고, 안전하고 편리하게 서비스에 접근할 수 있도록 하는 것을 목적으로 합니다.

## 2. 핵심 원칙
1. **자기 주권 신원 (Self-Sovereign Identity):** 사용자는 자신의 식별자(DID)와 개인정보를 스스로 통제하고 소유합니다.
2. **프라이버시 보호 (Privacy by Design):** 서비스 이용에 필요한 최소한의 정보만을 요청하며, 불필요한 개인정보 수집을 지양합니다.
3. **보안성 (Security):** 표준화된 DID 프로토콜(W3C DID, Verifiable Credentials)을 준수하여 위변조를 방지합니다.
4. **사용자 경험 (User Experience):** 복잡한 블록체인 개념을 숨기고 직관적인 로그인 경험을 제공합니다.

## 3. 적용 범위
본 정책은 MiID 플랫폼을 이용하는 모든 사용자(개인 및 기관)와 MiID 서비스를 제공하는 운영 주체에 적용됩니다.

## 4. 인증 및 로그인 프로세스

### 4.1 회원 가입 (DID 생성)
- 사용자는 모바일 앱 또는 웹 클라이언트를 통해 로컬 디바이스에서 비대칭 키 쌍(Public/Private Key)을 생성합니다.
- 생성된 Public Key를 기반으로 DID Document를 생성하고, 이를 블록체인(또는 DID 레지스트리)에 등록합니다.
- Private Key는 사용자의 디바이스 내 안전한 저장소(Secure Enclave/Keystore)에만 저장되며, 서버로 전송되지 않습니다.

### 4.2 자격증명(VC) 발급
- 신원 인증이 필요한 경우, 공인된 발급기관(Issuer)으로부터 검증가능한 자격증명(Verifiable Credential, VC)을 발급받아 디바이스에 저장합니다.

### 4.3 로그인 (DID Auth)
- 사용자는 서비스 접속 시, 서비스 제공자(Verifier)가 생성한 챌린지(Challenge) 메시지에 대해 자신의 Private Key로 전자서명하여 응답합니다.
- 서비스 제공자는 사용자의 DID를 통해 DID Document를 조회하고, Public Key로 서명을 검증하여 로그인을 완료합니다.
- 필요 시, 사용자는 로그인과 동시에 필요한 자격증명(VP, Verifiable Presentation)을 선택적으로 제출합니다.

## 5. 데이터 관리 정책

### 5.1 온체인 데이터 (On-chain)
- **DID Document:** DID 식별자, Public Key, 서비스 엔드포인트 정보.
- **개인정보 포함 금지:** 이름, 생년월일, 연락처 등 민감한 개인정보는 블록체인에 절대 저장하지 않습니다.

### 5.2 오프체인 데이터 (Off-chain)
- **Verifiable Credential (VC):** 사용자의 개인 단말기에 암호화되어 저장됩니다.
- **서비스 데이터:** 서비스 이용 로그 등은 기존 중앙화된 서버 또는 분산 스토리지에 안전하게 보관됩니다.

## 6. 보안 및 키 관리
- **키 분실 시:** Private Key는 복구 불가능하므로, 니모닉 코드(Mnemonic) 또는 소셜 복구(Social Recovery) 메커니즘을 통해 백업 및 복구 절차를 마련해야 합니다.
- **통신 보안:** 모든 통신은 TLS/SSL을 통해 암호화되어야 합니다.
- **세션 관리:** 로그인 성공 시 발급되는 세션 토큰(JWT 등)은 적절한 만료 시간을 가지며, 안전하게 관리되어야 합니다.

## 7. 정책 변경
본 정책은 기술 발전 및 법적 요구사항에 따라 변경될 수 있으며, 변경 시 사용자에게 사전에 고지합니다.

## 8. 로그인 및 동의 정책 (Login & Consent Policy)

### 8.1 최초 동의 (Initial Consent)
- **발생 시점:** 사용자가 서비스에 DID로 처음 로그인하거나, 새로운 서비스 연동을 시작할 때 발생합니다.
- **정책:**
    - 서비스 제공자는 요청하는 정보(Claims/VCs)의 항목, 이용 목적, 보유 기간을 사용자에게 명확히 제시해야 합니다.
    - 사용자는 MiID 앱을 통해 요청된 항목을 확인하고, 전자서명을 통해 명시적으로 동의를 제공합니다.
    - 동의 내역은 DID Document 또는 안전한 데이터 저장소에 기록되어 추후 검증 가능해야 합니다.

### 8.2 재동의 (Re-consent)
- **발생 시점:** 
    - 서비스가 요청하는 정보의 범위(Scope)가 변경되거나 확대될 때.
    - 법적 요구사항 또는 정책 변경으로 인해 기존 동의의 갱신이 필요할 때.
    - 동의 유효 기간이 만료되었을 때.
- **정책:**
    - 변경된 항목에 대해 사용자에게 재고지하고, 다시 한번 명시적인 서명 동의를 받아야 합니다.
    - 사용자가 재동의를 거부할 경우, 추가 정보가 필요한 기능의 이용은 제한될 수 있으나 기존 동의 범위 내의 기본 기능은 유지될 수 있습니다.

### 8.3 Step-up 인증 (Step-up Authentication)
- **발생 시점:** 
    - 금융 거래, 개인정보 대량 조회 등 높은 보안 수준이 요구되는 작업을 수행할 때.
    - 평소와 다른 기기 또는 장소에서 접근이 시도될 때.
- **정책:**
    - 일반적인 DID Auth 외에 추가적인 인증 수단(생체 인증, PIN, FIDO 등)을 요구하여 보안 등급을 상향합니다.
    - 인증 성공 시 해당 세션에 대해 한시적으로 권한을 상향 조정합니다.

### 8.4 권한 철회 (Revoke)
- **발생 시점:** 사용자가 더 이상 서비스를 이용하고 싶지 않거나, 특정 정보 제공에 대한 동의를 취소하고 싶을 때.
- **정책:**
    - 사용자는 언제든지 MiID 앱을 통해 부여된 권한을 철회(Revoke)할 수 있어야 합니다.
    - 철회 시 해당 서비스에 대한 접근 권한 및 정보 공유가 즉시 중단되어야 합니다.
    - 서비스 제공자는 철회 요청 접수 시 관련 데이터를 정책에 따라 파기하거나 접근을 차단해야 합니다.